
%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
% Conductivity matrix: T3
%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
function Ke=B2_2D_therm_Ke(X,mate)

k=mate(1);
x11=X(1,1); x21=X(2,1); x31=X(3,1);          % nodal coordinates
x12=X(1,2); x22=X(2,2); x32=X(3,2);
S=.5*((x21-x11)*(x32-x12)-...
      (x31-x11)*(x22-x12));                  % element area
G=[x22-x32,x32-x12,x12-x22;
   x31-x21,x11-x31,x21-x11]/(2*S);
Ke=S*k*G'*G;
